import numpy as np
import matplotlib.pyplot as plt

plt.rcParams.update({
    'font.size': 16,
    'axes.titlesize': 16,
    'axes.labelsize': 16,
    'xtick.labelsize': 16,
    'ytick.labelsize': 16,
    'legend.fontsize': 16,
    'lines.linewidth': 2,
    'font.family': 'sans-serif',
    'font.sans-serif': ['Arial', 'Liberation Sans', 'Bitstream Vera Sans', 'sans-serif'],
})


membership = np.array([
    [0.8315, 0.0275, 0.1042, 0.0368], [0.0375, 0.0312, 0.0573, 0.8739],
    [0.2857, 0.0732, 0.4325, 0.2087], [0.2164, 0.0467, 0.6672, 0.0697],
    [0.1316, 0.0682, 0.6557, 0.1444], [0.0558, 0.6629, 0.1281, 0.1532],
    [0.0544, 0.3267, 0.5342, 0.0847], [0.0401, 0.7350, 0.1012, 0.1236],
    [0.0004, 0.9970, 0.0015, 0.0011], [0.5482, 0.0854, 0.1781, 0.1883],
    [0.7265, 0.0311, 0.1984, 0.0439], [0.0255, 0.0635, 0.0519, 0.8591],
    [0.0710, 0.1149, 0.7607, 0.0534], [0.0660, 0.2301, 0.6329, 0.0710],
    [0.1052, 0.0380, 0.8013, 0.0555], [0.0249, 0.0406, 0.0406, 0.8939],
    [0.0692, 0.2060, 0.5048, 0.2200], [0.0023, 0.0019, 0.9942, 0.0016],
    [0.1541, 0.0901, 0.4207, 0.3351], [0.0385, 0.0859, 0.0687, 0.8068],
    [0.6323, 0.0523, 0.2558, 0.0596], [0.1045, 0.0914, 0.7491, 0.0549],
    [0.8791, 0.0185, 0.0621, 0.0403], [0.1052, 0.1198, 0.1254, 0.6496],
    [0.0585, 0.1118, 0.7802, 0.0496], [0.1749, 0.0855, 0.6762, 0.0634],
    [0.0952, 0.0765, 0.6781, 0.1503], [0.0577, 0.6948, 0.1548, 0.0927],
    [0.4968, 0.0540, 0.3868, 0.0624], [0.0418, 0.6000, 0.1721, 0.1862],
    [0.0061, 0.0062, 0.9820, 0.0057], [0.1645, 0.0909, 0.6805, 0.0641],
    [0.7960, 0.0379, 0.1077, 0.0584], [0.5104, 0.0910, 0.3104, 0.0881],
    [0.1263, 0.0868, 0.5624, 0.2245], [0.1311, 0.0728, 0.6345, 0.1617],
    [0.0510, 0.4288, 0.4189, 0.1012], [0.0346, 0.7468, 0.0931, 0.1255],
    [0.1558, 0.0410, 0.7557, 0.0475], [0.0096, 0.9341, 0.0371, 0.0192],
    [0.0015, 0.0014, 0.9959, 0.0011], [0.0224, 0.8060, 0.0991, 0.0725],
    [0.3185, 0.0486, 0.5686, 0.0643], [0.8746, 0.0200, 0.0636, 0.0418],
    [0.8915, 0.0186, 0.0599, 0.0299], [0.0059, 0.0065, 0.9830, 0.0047],
    [0.9215, 0.0126, 0.0472, 0.0187], [0.0557, 0.1617, 0.6655, 0.1172],
    [0.8062, 0.0231, 0.1365, 0.0342], [0.0684, 0.6070, 0.1663, 0.1583],
    [0.8062, 0.0231, 0.1365, 0.0342], [0.0681, 0.5374, 0.3098, 0.0847],
    [0.0282, 0.0445, 0.9027, 0.0246], [0.0638, 0.1326, 0.6555, 0.1481],
    [0.7565, 0.0432, 0.1454, 0.0549], [0.2317, 0.0803, 0.2820, 0.4060],
    [0.5921, 0.0451, 0.2635, 0.0994], [0.0258, 0.8453, 0.0734, 0.0556],
    [0.6423, 0.0558, 0.1496, 0.1522], [0.0675, 0.0359, 0.8440, 0.0526],
    [0.9700, 0.0046, 0.0167, 0.0086], [0.0191, 0.8364, 0.0896, 0.0549],
    [0.2975, 0.0510, 0.5910, 0.0605], [0.0993, 0.0817, 0.6497, 0.1693],
    [0.3178, 0.1078, 0.1881, 0.3863], [0.0623, 0.3277, 0.3965, 0.2134],
    [0.5064, 0.0750, 0.1791, 0.2396], [0.0685, 0.5488, 0.2975, 0.0852],
    [0.9147, 0.0133, 0.0526, 0.0193], [0.5149, 0.0655, 0.1908, 0.2288],
    [0.3399, 0.0638, 0.5310, 0.0653], [0.5136, 0.0441, 0.3777, 0.0647],
    [0.0057, 0.0045, 0.9861, 0.0038], [0.0128, 0.9087, 0.0536, 0.0249],
    [0.7455, 0.0308, 0.1566, 0.0670], [0.0102, 0.0065, 0.9766, 0.0066],
    [0.0383, 0.0304, 0.8922, 0.0392], [0.1459, 0.3201, 0.4214, 0.1126],
    [0.0684, 0.2177, 0.4944, 0.2195], [0.0663, 0.0891, 0.7168, 0.1277],
    [0.2601, 0.0666, 0.6104, 0.0629], [0.0234, 0.8556, 0.0661, 0.0549],
    [0.0541, 0.3277, 0.5086, 0.1096], [0.0686, 0.3559, 0.4939, 0.0815],
    [0.0162, 0.0251, 0.9401, 0.0186], [0.0229, 0.8200, 0.0707, 0.0864],
    [0.0405, 0.6161, 0.2647, 0.0787], [0.0362, 0.0457, 0.8915, 0.0266],
    [0.0171, 0.8575, 0.0656, 0.0598], [0.0319, 0.0255, 0.9240, 0.0186],
    [0.0980, 0.0342, 0.8214, 0.0464], [0.0480, 0.1605, 0.7305, 0.0610],
    [0.0035, 0.0062, 0.0070, 0.9832], [0.0221, 0.0265, 0.0456, 0.9058],
    [0.0476, 0.5016, 0.3488, 0.1020], [0.4584, 0.0708, 0.2004, 0.2705],
    [0.1221, 0.1517, 0.6521, 0.0741], [0.0161, 0.0114, 0.9630, 0.0095],
    [0.0531, 0.4018, 0.4243, 0.1208], [0.2376, 0.0792, 0.1819, 0.5013],
    [0.0653, 0.2862, 0.3242, 0.3243], [0.0242, 0.0290, 0.9287, 0.0181],
    [0.0081, 0.0101, 0.9748, 0.0070], [0.0195, 0.8595, 0.0853, 0.0357],
    [0.0697, 0.0702, 0.7494, 0.1107], [0.0728, 0.3507, 0.1459, 0.4307],
    [0.0007, 0.9949, 0.0025, 0.0018], [0.0287, 0.0774, 0.0604, 0.8335],
    [0.3242, 0.0483, 0.5601, 0.0674], [0.0615, 0.0278, 0.8736, 0.0370],
    [0.0138, 0.9128, 0.0435, 0.0299], [0.0836, 0.5636, 0.1682, 0.1846],
    [0.0314, 0.0517, 0.8892, 0.0277], [0.0323, 0.0345, 0.0446, 0.8886],
    [0.8735, 0.0215, 0.0653, 0.0396], [0.9763, 0.0036, 0.0144, 0.0057]
])

normal_tissue = membership[::2]  # Even indices
tumor_tissue  = membership[1::2] # Odd indices

num_points = min(len(normal_tissue), len(tumor_tissue))
normal_tissue = normal_tissue[:num_points]
tumor_tissue  = tumor_tissue[:num_points]

titles = [
    "(a) Hypo + Low expression",
    "(b) Hypo + High expression",
    "(c) Hyper + Low expression",
    "(d) Hyper + High expression"
]

xlabels = ["Sample number"] * 4
ylabels = ["$\mu_{A}(x)$"] * 4

fig, axes = plt.subplots(2, 2, figsize=(12, 8))
axes = axes.ravel()

for i, ax in enumerate(axes):

    x_normal = np.arange(len(normal_tissue[:, i]))
    x_tumor  = np.arange(len(tumor_tissue[:, i]))

    ax.scatter(
        x_normal,
        normal_tissue[:, i],
        label="Normal tissue",
        color="tab:blue",
        alpha=0.4,
        s=20,
        zorder=3
    )

    ax.scatter(
        x_tumor,
        tumor_tissue[:, i],
        label="Tumor tissue",
        color="tab:red",
        alpha=0.3,
        s=20,
        zorder=3
    )

    # Mean and STD
    normal_mean = np.mean(normal_tissue[:, i])
    normal_std  = np.std(normal_tissue[:, i])
    tumor_mean  = np.mean(tumor_tissue[:, i])
    tumor_std   = np.std(tumor_tissue[:, i])

    ax.axhline(normal_mean, color="tab:blue", linestyle=":",
               linewidth=3, alpha=1, label="Normal mean", zorder=2)
    ax.axhline(tumor_mean, color="tab:red", linestyle=":",
               linewidth=3, alpha=1, label="Tumor mean", zorder=2)
    
    ax.set_title(titles[i])
    ax.set_xlabel(xlabels[i])
    ax.set_ylabel(ylabels[i])
    ax.grid(True, linestyle=':', alpha=0.6)


handles, labels = [], []
for ax in axes:
    h, l = ax.get_legend_handles_labels()
    handles.extend(h)
    labels.extend(l)

uniq = dict(zip(labels, handles))

fig.subplots_adjust(
    left=0.07, right=0.98,
    bottom=0.08, top=0.86,   # top space for legend
    wspace=0.25, hspace=0.35 # spacing between panels
)

fig.legend(
    uniq.values(), uniq.keys(),
    loc='upper center',
    ncol=4, fontsize=14, frameon=False
)

plt.tight_layout(rect=[0, 0, 1, 0.95])

plt.show()
