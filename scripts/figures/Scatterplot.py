import numpy as np
import matplotlib.pyplot as plt
risk_matrix = np.array([
    [0.307, 0.358, 0.334],
    [0.233, 0.349, 0.417],
    [0.284, 0.321, 0.394],
    [0.200, 0.300, 0.500],
    [0.294, 0.296, 0.410],
    [0.194, 0.227, 0.624],
    [0.318, 0.312, 0.370],
    [0.159, 0.343, 0.496],
    [0.339, 0.242, 0.418],
    [0.100, 0.300, 0.600],
    [0.310, 0.226, 0.463],
    [0.180, 0.245, 0.575],
    [0.301, 0.264, 0.435],
    [0.301, 0.260, 0.440],
    [0.345, 0.294, 0.359],
    [0.262, 0.349, 0.388],
    [0.245, 0.252, 0.503],
    [0.382, 0.304, 0.314],
    [0.401, 0.299, 0.299],
    [0.270, 0.260, 0.470],
    [0.315, 0.281, 0.402],
    [0.311, 0.277, 0.410],
    [0.306, 0.357, 0.336],
    [0.248, 0.352, 0.400],
    [0.388, 0.256, 0.357],
    [0.188, 0.253, 0.560],
    [0.435, 0.291, 0.274],
    [0.263, 0.301, 0.436],
    [0.363, 0.305, 0.332],
    [0.100, 0.190, 0.710],
    [0.770, 0.100, 0.130],
    [0.050, 0.130, 0.820],
    [0.270, 0.260, 0.470],
    [0.270, 0.230, 0.500],
    [0.123, 0.132, 0.744],
    [0.120, 0.129, 0.750],
    [0.166, 0.097, 0.736],
    [0.060, 0.124, 0.816],
    [0.216, 0.200, 0.584],
    [0.013, 0.112, 0.875],
    [0.350, 0.220, 0.430],
    [0.028, 0.109, 0.863],
    [0.705, 0.175, 0.118],
    [0.104, 0.356, 0.540],
    [0.449, 0.341, 0.210],
    [0.576, 0.205, 0.219],
    [0.503, 0.319, 0.178],
    [0.199, 0.109, 0.692],
    [0.458, 0.266, 0.276],
    [0.139, 0.231, 0.629],
    [0.857, 0.096, 0.047],
    [0.311, 0.246, 0.443],
    [0.043, 0.232, 0.724],
    [0.043, 0.207, 0.750],
    [0.126, 0.232, 0.642],
    [0.093, 0.237, 0.669],
    [0.101, 0.303, 0.696],
    [0.246, 0.156, 0.598],
    [0.232, 0.296, 0.471],
    [0.222, 0.258, 0.519],
    [0.417, 0.245, 0.339],
    [0.314, 0.148, 0.538],
    [0.302, 0.276, 0.422],
    [0.159, 0.164, 0.672],
    [0.310, 0.286, 0.404],
    [0.256, 0.314, 0.428],
    [0.333, 0.293, 0.374],
    [0.266, 0.333, 0.401],
    [0.339, 0.314, 0.348],
    [0.262, 0.316, 0.421],
    [0.373, 0.289, 0.329],
    [0.250, 0.336, 0.415],
    [0.154, 0.321, 0.524],
    [0.346, 0.250, 0.405],
    [0.050, 0.300, 0.650],
    [0.238, 0.303, 0.459],
    [0.117, 0.301, 0.582],
    [0.381, 0.274, 0.345],
    [0.315, 0.320, 0.365],
    [0.269, 0.307, 0.425],
    [0.282, 0.227, 0.491],
    [0.214, 0.270, 0.500],
    [0.467, 0.275, 0.258],
    [0.267, 0.275, 0.258],
    [0.216, 0.298, 0.486],
    [0.281, 0.256, 0.464],
    [0.314, 0.328, 0.359],
    [0.262, 0.282, 0.457],
    [0.377, 0.273, 0.394],
    [0.332, 0.294, 0.375],
    [0.255, 0.273, 0.472],
    [0.212, 0.259, 0.493],
    [0.220, 0.280, 0.501],
    [0.350, 0.273, 0.355],
    [0.262, 0.338, 0.400],
    [0.370, 0.298, 0.332],
    [0.367, 0.273, 0.360],
    [0.340, 0.304, 0.350],
    [0.219, 0.315, 0.566],
    [0.236, 0.297, 0.466],
    [0.373, 0.318, 0.308],
    [0.360, 0.264, 0.376],
    [0.213, 0.301, 0.486],
    [0.284, 0.301, 0.415],
    [0.259, 0.322, 0.417],
    [0.283, 0.283, 0.434],
    [0.280, 0.280, 0.450],
    [0.236, 0.325, 0.438],
    [0.437, 0.305, 0.347],
    [0.243, 0.336, 0.419],
    [0.243, 0.335, 0.420],
    [0.462, 0.241, 0.302],
    [0.222, 0.314, 0.437],
    [0.278, 0.356, 0.366]
])

plt.style.use("seaborn-v0_8-whitegrid")   # clean modern style
plt.rcParams.update({
    'font.size': 16,
    'axes.titlesize': 16,
    'axes.labelsize': 16,
    'xtick.labelsize': 16,
    'ytick.labelsize': 16,
    'legend.fontsize': 16,
    'lines.linewidth': 2,
    'font.family': 'sans-serif',
    'font.sans-serif': ['Arial', 'Liberation Sans', 'Bitstream Vera Sans', 'sans-serif'],
})

colors = ["tab:green", "tab:blue", "tab:red"]   # green, blue, red
risk_labels = ["Low", "Medium", "High"]

risk_matrix = risk_matrix / risk_matrix.sum(axis=1, keepdims=True)
normal_tissue = risk_matrix[::2]
tumor_tissue = risk_matrix[1::2]

num_points = min(len(normal_tissue), len(tumor_tissue))
normal_tissue = normal_tissue[:num_points]
tumor_tissue = tumor_tissue[:num_points]

samples_tumor = np.arange(1, tumor_tissue.shape[0] + 1)
samples_normal = np.arange(1, normal_tissue.shape[0] + 1)


fig, axes = plt.subplots(1, 2, figsize=(15, 5), sharey=True)

def p_scatter(ax, data, sample_idx, title):
    for j in range(data.shape[1]):
        ax.scatter(
            sample_idx, data[:, j],
            label=f"{risk_labels[j]}",
            color=colors[j],
            s=20,
            alpha=0.5,
            edgecolor="white",
            linewidth=0.6
        )

        # Mean line
        mean_val = data[:, j].mean()
        ax.axhline(
            mean_val,
            color=colors[j],
            linestyle="--",
            linewidth=2
        )

    ax.set_title(title)
    ax.set_xlabel("Sample Number")
    ax.grid(True, linestyle=":", alpha=0.6)
    ax.legend(loc="upper right", frameon=False, fontsize=14)


p_scatter(axes[0], tumor_tissue, samples_tumor, "(a)")
axes[0].set_ylabel("Risk Value")

p_scatter(axes[1], normal_tissue, samples_normal, "(b)")

plt.tight_layout()
plt.show()
