import numpy as np
import matplotlib.pyplot as plt

# Membership degree matrix for 116 samples Ã— 4 clusters
membership = np.array([
    [0.0321, 0.6698, 0.2842, 0.0139],   # Sample 1 (Normal)
    [0.2201, 0.0487, 0.0852, 0.6460],   # Sample 2 (Tumor)
    [0.0391, 0.2491, 0.6968, 0.0151],   # Sample 3 (Normal)
    [0.9889, 0.0017, 0.0053, 0.0041],   # Sample 4 (Tumor)
    [0.0495, 0.4830, 0.4440, 0.0236],   # Sample 5 (Normal)
    [0.3415, 0.0520, 0.0965, 0.5100],   # Sample 6 (Tumor)
    [0.0301, 0.8522, 0.1013, 0.0165],   # Sample 7 (Normal)
    [0.7647, 0.0443, 0.1386, 0.0524],   # Sample 8 (Tumor)
    [0.0263, 0.8753, 0.0848, 0.0136],   # Sample 9 (Normal)
    [0.4035, 0.1825, 0.3196, 0.0944],   # Sample 10 (Tumor)
    [0.0067, 0.9638, 0.0262, 0.0033],   # Sample 11 (Normal)
    [0.4179, 0.1574, 0.3434, 0.0814],   # Sample 12 (Tumor)
    [0.0292, 0.0478, 0.9114, 0.0115],   # Sample 13 (Normal)
    [0.2847, 0.0382, 0.1031, 0.5740],   # Sample 14 (Tumor)
    [0.0459, 0.1974, 0.7409, 0.0158],   # Sample 15 (Normal)
    [0.4831, 0.0882, 0.1505, 0.2782],   # Sample 16 (Tumor)
    [0.0134, 0.0266, 0.9558, 0.0042],   # Sample 17 (Normal)
    [0.0645, 0.2070, 0.7080, 0.0205],   # Sample 18 (Tumor)
    [0.0879, 0.0576, 0.8252, 0.0294],   # Sample 19 (Normal)
    [0.2647, 0.0486, 0.0877, 0.5990],   # Sample 20 (Tumor)
    [0.0457, 0.5996, 0.3320, 0.0226],   # Sample 21 (Normal)
    [0.6784, 0.0349, 0.1178, 0.1688],   # Sample 22 (Tumor)
    [0.0517, 0.7681, 0.1572, 0.0230],   # Sample 23 (Normal)
    [0.4414, 0.1476, 0.3286, 0.0824],   # Sample 24 (Tumor)
    [0.0191, 0.0531, 0.9213, 0.0065],   # Sample 25 (Normal)
    [0.9253, 0.0105, 0.0386, 0.0256],   # Sample 26 (Tumor)
    [0.0215, 0.8454, 0.1242, 0.0089],   # Sample 27 (Normal)
    [0.1684, 0.0168, 0.0410, 0.7738],   # Sample 28 (Tumor)
    [0.0320, 0.8028, 0.1479, 0.0172],   # Sample 29 (Normal)
    [0.5683, 0.0563, 0.2634, 0.1120],  # Sample 30 (Tumor)
    [0.0267, 0.8548, 0.1070, 0.0115],
    [0.3919, 0.0419, 0.1207, 0.4455],
    [0.0509, 0.6890, 0.2316, 0.0286],
    [0.8489, 0.0201, 0.0757, 0.0553],
    [0.0189, 0.0381, 0.9357, 0.0073],
    [0.8724, 0.0212, 0.0531, 0.0533],
    [0.0418, 0.2418, 0.7010, 0.0154],
    [0.2031, 0.0537, 0.1259, 0.6173],
    [0.0595, 0.0990, 0.8151, 0.0264],
    [0.3395, 0.0473, 0.0899, 0.5232],
    [0.1475, 0.0683, 0.7390, 0.0452],
    [0.0410, 0.0078, 0.0154, 0.9358],
    [0.0314, 0.8498, 0.1044, 0.0144],
    [0.4858, 0.1187, 0.1885, 0.2070],
    [0.0188, 0.8695, 0.1023, 0.0094],
    [0.5212, 0.1242, 0.2101, 0.1445],
    [0.0148, 0.9239, 0.0544, 0.0069],
    [0.5198, 0.0603, 0.3541, 0.0657],
    [0.0289, 0.8654, 0.0911, 0.0145],
    [0.4302, 0.0404, 0.1176, 0.4119],
    [0.0134, 0.9238, 0.0558, 0.0070],
    [0.5796, 0.0449, 0.1524, 0.2231],
    [0.0436, 0.3818, 0.5577, 0.0169],
    [0.3275, 0.0234, 0.0568, 0.5923],
    [0.0997, 0.0686, 0.8089, 0.0227],
    [0.7365, 0.0235, 0.0689, 0.1711],
    [0.0503, 0.6616, 0.2688, 0.0193],
    [0.0197, 0.0039, 0.0081, 0.9683],
    [0.0371, 0.1980, 0.7510, 0.0138],
    [0.2434, 0.0274, 0.0567, 0.6725],
    [0.0048, 0.9665, 0.0266, 0.0022],
    [0.2031, 0.1928, 0.5559, 0.0483],
    [0.1238, 0.5647, 0.2564, 0.0550],
    [0.3692, 0.0862, 0.3684, 0.1761],
    [0.0748, 0.6740, 0.2203, 0.0309],
    [0.9498, 0.0068, 0.0231, 0.0203],
    [0.0175, 0.8558, 0.1187, 0.0080],
    [0.8456, 0.0155, 0.0410, 0.0978],
    [0.2076, 0.1143, 0.5715, 0.1066],
    [0.1003, 0.0282, 0.0540, 0.8175],
    [0.2502, 0.0937, 0.5554, 0.1007],  # Sample 71
    [0.7553, 0.0414, 0.1553, 0.0480],  # Sample 72
    [0.5264, 0.0717, 0.3440, 0.0579],  # Sample 73
    [0.0386, 0.0066, 0.0132, 0.9415],  # Sample 74
    [0.0532, 0.7734, 0.1444, 0.0290],  # Sample 75
    [0.0891, 0.0240, 0.0458, 0.8410],  # Sample 76
    [0.0383, 0.0788, 0.8668, 0.0161],  # Sample 77
    [0.0419, 0.0093, 0.0183, 0.9305],  # Sample 78
    [0.1572, 0.1209, 0.6420, 0.0800],  # Sample 79
    [0.1221, 0.0125, 0.0292, 0.8362],  # Sample 80
    [0.0236, 0.8416, 0.1227, 0.0121],  # Sample 81
    [0.1064, 0.0291, 0.0585, 0.8059],  # Sample 82
    [0.0191, 0.8886, 0.0822, 0.0101],  # Sample 83
    [0.1512, 0.0942, 0.6909, 0.0637],  # Sample 84
    [0.0396, 0.5089, 0.4352, 0.0164],  # Sample 85
    [0.0555, 0.0126, 0.0243, 0.9077],  # Sample 86
    [0.0328, 0.0676, 0.8861, 0.0135],  # Sample 87
    [0.1913, 0.0539, 0.1219, 0.6329],  # Sample 88
    [0.0449, 0.1318, 0.8036, 0.0198],  # Sample 89
    [0.3610, 0.0690, 0.5083, 0.0617],  # Sample 90
    [0.2285, 0.2077, 0.5094, 0.0544],  # Sample 91
    [0.0017, 0.0003, 0.0006, 0.9974],  # Sample 92
    [0.0434, 0.8016, 0.1306, 0.0243],  # Sample 93
    [0.9559, 0.0069, 0.0234, 0.0137],  # Sample 94
    [0.0177, 0.8540, 0.1206, 0.0076],  # Sample 95
    [0.4833, 0.1237, 0.3159, 0.0772],  # Sample 96
    [0.0229, 0.8625, 0.1025, 0.0121],  # Sample 97
    [0.4292, 0.0971, 0.1570, 0.3168],  # Sample 98
    [0.0694, 0.7202, 0.1770, 0.0334],  # Sample 99
    [0.3768, 0.0802, 0.2801, 0.2628],  # Sample 100
    [0.0381, 0.5609, 0.3846, 0.0165],  # Sample 101
    [0.1255, 0.0391, 0.0731, 0.7622],  # Sample 102
    [0.0159, 0.8687, 0.1083, 0.0071],  # Sample 103
    [0.0919, 0.0160, 0.0312, 0.8609],  # Sample 104
    [0.0551, 0.5495, 0.3668, 0.0285],  # Sample 105
    [0.8459, 0.0168, 0.0428, 0.0945],  # Sample 106
    [0.0049, 0.9731, 0.0197, 0.0024],  # Sample 107
    [0.9251, 0.0114, 0.0300, 0.0335],  # Sample 108
    [0.3769, 0.0750, 0.2483, 0.2998],  # Sample 109
    [0.1432, 0.0311, 0.0719, 0.7538],  # Sample 110
    [0.0241, 0.8088, 0.1554, 0.0116],  # Sample 111
    [0.8546, 0.0176, 0.0439, 0.0839],  # Sample 112
    [0.1631, 0.1892, 0.6070, 0.0408],  # Sample 113
    [0.2075, 0.0233, 0.0592, 0.7100],  # Sample 114
])

# Labels: alternating pattern (0 = Normal, 1 = Tumor)
labels = np.array([0,1]*58)

samples = np.arange(1, 115)
clusters_colors = ['red', 'green', 'blue', 'orange']

# --- Bar Plot ---
fig, ax = plt.subplots(figsize=(20, 8))
bottom = np.zeros(len(membership))

for i in range(4):
    ax.bar(samples, membership[:, i], bottom=bottom, color=clusters_colors[i], label=f'Cluster {i+1}')
    bottom += membership[:, i]

# Background shading
for i, label in enumerate(labels):
    if label == 0:
        ax.axvspan(i+0.5, i+1.5, color='lightblue', alpha=0.2)
    else:
        ax.axvspan(i+0.5, i+1.5, color='lightcoral', alpha=0.2)
# Labels and legend
ax.set_xlabel("Sample number", fontsize=18)
ax.set_ylabel("Membership degree", fontsize=18)
ax.legend(fontsize=18, loc='upper left')
ax.set_xticks(np.arange(0, 117, 10))
ax.set_ylim(0, 1.05)
plt.xticks(fontsize=18)
plt.yticks(fontsize=18)
plt.grid(True, axis='y')
#plt.title("Fuzzy Membership Degrees per Sample (Bar Plot)", fontsize=20)
plt.subplots_adjust(left=0.1) 
plt.tight_layout(pad=4.0)
plt.show()
