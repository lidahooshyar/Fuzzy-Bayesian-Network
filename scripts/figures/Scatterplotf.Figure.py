import numpy as np
import matplotlib.pyplot as plt

# -----------------------------
# Placeholder 114x3 risk matrix
# Columns: [Low risk, Medium risk, High risk]
# Replace these numbers with your actual probabilities
risk_matrix = np.array([
    [0.307, 0.358, 0.334],
    [0.233, 0.349, 0.417],
    [0.284, 0.321, 0.394],
    [0.200, 0.300, 0.500],
    [0.294, 0.296, 0.410],
    [0.194, 0.227, 0.624],
    [0.318, 0.312, 0.370],
    [0.159, 0.343, 0.496],
    [0.339, 0.242, 0.418],
    [0.100, 0.300, 0.600],
    [0.310, 0.226, 0.463],
    [0.180, 0.245, 0.575],
    [0.301, 0.264, 0.435],
    [0.301, 0.260, 0.440],
    [0.345, 0.294, 0.359],
    [0.262, 0.349, 0.388],
    [0.245, 0.252, 0.503],
    [0.382, 0.304, 0.314],
    [0.401, 0.299, 0.299],
    [0.270, 0.260, 0.470],
    [0.315, 0.281, 0.402],
    [0.311, 0.277, 0.410],
    [0.306, 0.357, 0.336],
    [0.248, 0.352, 0.400],
    [0.388, 0.256, 0.357],
    [0.188, 0.253, 0.560],
    [0.435, 0.291, 0.274],
    [0.263, 0.301, 0.436],
    [0.363, 0.305, 0.332],
    [0.100, 0.190, 0.710],
    [0.770, 0.100, 0.130],
    [0.050, 0.130, 0.820],
    [0.270, 0.260, 0.470],
    [0.270, 0.230, 0.500],
    [0.123, 0.132, 0.744],
    [0.120, 0.129, 0.750],
    [0.166, 0.097, 0.736],
    [0.060, 0.124, 0.816],
    [0.216, 0.200, 0.584],
    [0.013, 0.112, 0.875],
    [0.350, 0.220, 0.430],
    [0.028, 0.109, 0.863],
    [0.705, 0.175, 0.118],
    [0.104, 0.356, 0.540],
    [0.449, 0.341, 0.210],
    [0.576, 0.205, 0.219],
    [0.503, 0.319, 0.178],
    [0.199, 0.109, 0.692],
    [0.458, 0.266, 0.276],
    [0.139, 0.231, 0.629],
    [0.857, 0.096, 0.047],
    [0.311, 0.246, 0.443],
    [0.043, 0.232, 0.724],
    [0.043, 0.207, 0.750],
    [0.126, 0.232, 0.642],
    [0.093, 0.237, 0.669],
    [0.101, 0.303, 0.696],
    [0.246, 0.156, 0.598],
    [0.232, 0.296, 0.471],
    [0.222, 0.258, 0.519],
    [0.417, 0.245, 0.339],
    [0.314, 0.148, 0.538],
    [0.302, 0.276, 0.422],
    [0.159, 0.164, 0.672],
    [0.310, 0.286, 0.404],
    [0.256, 0.314, 0.428],
    [0.333, 0.293, 0.374],
    [0.266, 0.333, 0.401],
    [0.339, 0.314, 0.348],
    [0.262, 0.316, 0.421],
    [0.373, 0.289, 0.329],
    [0.250, 0.336, 0.415],
    [0.154, 0.321, 0.524],
    [0.346, 0.250, 0.405],
    [0.050, 0.300, 0.650],
    [0.238, 0.303, 0.459],
    [0.117, 0.301, 0.582],
    [0.381, 0.274, 0.345],
    [0.315, 0.320, 0.365],
    [0.269, 0.307, 0.425],
    [0.282, 0.227, 0.491],
    [0.214, 0.270, 0.500],
    [0.467, 0.275, 0.258],
    [0.267, 0.275, 0.258],
    [0.216, 0.298, 0.486],
    [0.281, 0.256, 0.464],
    [0.314, 0.328, 0.359],
    [0.262, 0.282, 0.457],
    [0.377, 0.273, 0.394],
    [0.332, 0.294, 0.375],
    [0.255, 0.273, 0.472],
    [0.212, 0.259, 0.493],
    [0.220, 0.280, 0.501],
    [0.350, 0.273, 0.355],
    [0.262, 0.338, 0.400],
    [0.370, 0.298, 0.332],
    [0.367, 0.273, 0.360],
    [0.340, 0.304, 0.350],
    [0.219, 0.315, 0.566],
    [0.236, 0.297, 0.466],
    [0.373, 0.318, 0.308],
    [0.360, 0.264, 0.376],
    [0.213, 0.301, 0.486],
    [0.284, 0.301, 0.415],
    [0.259, 0.322, 0.417],
    [0.283, 0.283, 0.434],
    [0.280, 0.280, 0.450],
    [0.236, 0.325, 0.438],
    [0.437, 0.305, 0.347],
    [0.243, 0.336, 0.419],
    [0.243, 0.335, 0.420],
    [0.462, 0.241, 0.302],
    [0.222, 0.314, 0.437],
    [0.278, 0.356, 0.366]
])

# Normalize rows so they sum to 1
risk_matrix = risk_matrix / risk_matrix.sum(axis=1, keepdims=True)

# -----------------------------
# Sample indices (1 to 114)
samples = np.arange(1, risk_matrix.shape[0] + 1)

# -----------------------------
# Increase font globally
plt.rcParams.update({'font.size': 18})

# -----------------------------
# Plot with background shading
plt.figure(figsize=(16,6))

# Background: Odd = Normal, Even = Tumor
for i in range(risk_matrix.shape[0]):
    if i % 2 == 0:  # sample 1,3,5,... Normal
        plt.axvspan(i + 0.5, i + 1.5, color='lightgreen', alpha=0.1)
    else:           # sample 2,4,6,... Tumor
        plt.axvspan(i + 0.5, i + 1.5, color='lightcoral', alpha=0.1)

# Scatter points for Low / Medium / High risk
plt.scatter(samples, risk_matrix[:,0], color='green', label='Low risk', marker='o')
plt.scatter(samples, risk_matrix[:,1], color='blue', label='Medium risk', marker='o')
plt.scatter(samples, risk_matrix[:,2], color='red', label='High risk', marker='o')

# Labels and ticks
plt.xlabel("Sample number", fontsize=18)
plt.ylabel("Risk probability", fontsize=18)
plt.xticks(fontsize=18)
plt.yticks(fontsize=18)

# Legend
plt.legend(loc='upper left', fontsize=18)

# Axes limits and layout
plt.xlim(0, risk_matrix.shape[0]+1)
plt.ylim(0, 1)
plt.tight_layout()

# Show plot
plt.show()
